import{D as m,G as U,Gb as c,J as u,Zc as f,g as p,k as n,l as a,n as l,t,yb as h}from"./chunk-RFUKYTJG.js";var v=class s{constructor(e,r){this.httpClient=e;this.router=r}usersUrl=f.USERS_URL;_authUser$=new p(null);authUser$=this._authUser$.asObservable();register(e){return this.httpClient.post(this.usersUrl,e).pipe(m(r=>{this._authUser$.next(r)}),t(r=>a(()=>new Error(`Error al registrar usuario: ${r.message}`))))}login(e,r){return this.httpClient.get(`${this.usersUrl}`,{params:{email:e,password:r}}).pipe(l(o=>{if(o[0]){let i=o[0];return localStorage.setItem("token",i.token),this._authUser$.next(i),i}else return null}),t(o=>a(()=>new Error("No se pudo iniciar sesi\xF3n"))))}logout(){this._authUser$.next(null),localStorage.removeItem("token"),this.router.navigate(["/welcome"])}verifyToken(){let e=localStorage.getItem("token");return e?this.httpClient.get(`${this.usersUrl}?token=${e}`).pipe(l(r=>r[0]?(this._authUser$.next(r[0]),!0):!1),t(r=>n(!1))):n(!1)}getCurrentUser(){return this._authUser$.value}static \u0275fac=function(r){return new(r||s)(u(h),u(c))};static \u0275prov=U({token:s,factory:s.\u0275fac,providedIn:"root"})};export{v as a};
